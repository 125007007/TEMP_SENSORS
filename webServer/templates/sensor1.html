<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
    <script src="../static/raphael-2.1.4.min.js"></script>
    <script src="../static/justgage.js"></script>
    <title>Hello, world!</title>
  </head>
  <body class="bg-dark">
	  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
	  <div class="container-fluid">
	    <a class="navbar-brand" href="/">Home</a>
	    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
	      <span class="navbar-toggler-icon"></span>
	    </button>
	    <div class="collapse navbar-collapse" id="navbarNav">
	      <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="/sensor1">In Portacom</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/sensor2">Under Portacom</a>
          </li>
	      </ul>
	    </div>
	  </div>
	</nav>
	<h1>{{ name_last }} Sensor Data </h1>
    <div id="g1"></div>
    <div id="g2"></div>
	<div class="d-flex justify-content-center">
		<p class="p-3 mb-2 bg-secondary text-white">Last Reading: {{ date_last }}{{ time_last }}(Updated every 1 minute)</p>
	</div>
	<div class="d-flex justify-content-center">
		<a class="btn btn-secondary btn-lg active m-3" role="button"href="/sensor1">Refresh</a>
	</div>
    <div class="d-flex justify-content-around">
        <canvas id="tempChart" width="950" height="380"></canvas>
        <canvas id="humChart" width="950" height="380"></canvas>
    </div>

    <script>
      // Global parameters:
      // do not resize the chart canvas when its container does (keep at 600x400px)
      Chart.defaults.global.responsive = false;

      // define the chart data
      var chartData = {
        labels : [{% for item in time %}
                   "{{item}}",
                  {% endfor %}],
        datasets : [{
            label: 'Temperature',
            fill: true,
            lineTension: 0.1,
            backgroundColor: "rgba(75,192,192,0.2)",
            borderColor: "rgba(75,192,192,1)",
            borderCapStyle: 'butt',
            borderDash: [],
            borderDashOffset: 0.0,
            borderJoinStyle: 'miter',
            pointBorderColor: "rgba(75,192,192,1)",
            pointBackgroundColor: "#fff",
            pointBorderWidth: 1,
            pointHoverRadius: 5,
            pointHoverBackgroundColor: "rgba(75,192,192,1)",
            pointHoverBorderColor: "rgba(220,220,220,1)",
            pointHoverBorderWidth: 2,
            pointRadius: 1,
            pointHitRadius: 10,
            data : [{% for item in temp %}
                      {{item}},
                    {% endfor %}],
            spanGaps: false
        }]
      }

      // get chart canvas
      var holder = document.getElementById("tempChart");
      var ctx = document.getElementById("tempChart").getContext("2d");

      // create the chart using the chart canvas
      var tempChart = new Chart(ctx, {
        type: 'line',
        data: chartData,
        options: {
          tooltips: {
            enabled: true,
            mode: 'single',
            callbacks: {
              label: function(tooltipItems, data) {
                       return tooltipItems.yLabel + ' degrees';
                     }
            }
          },
        }
      });
    
    </script>

<script>
    // Global parameters:
    // do not resize the chart canvas when its container does (keep at 600x400px)
    Chart.defaults.global.responsive = false;

    // define the chart data
    var chartData = {
      labels : [{% for item in time %}
                 "{{item}}",
                {% endfor %}],
      datasets : [{
          label: 'Humidity',
          fill: true,
          lineTension: 0.1,
          backgroundColor: "rgba(75,192,192,0.2)",
          borderColor: "rgba(75,192,192,1)",
          borderCapStyle: 'butt',
          borderDash: [],
          borderDashOffset: 0.0,
          borderJoinStyle: 'miter',
          pointBorderColor: "rgba(75,192,192,1)",
          pointBackgroundColor: "#fff",
          pointBorderWidth: 1,
          pointHoverRadius: 5,
          pointHoverBackgroundColor: "rgba(75,192,192,1)",
          pointHoverBorderColor: "rgba(220,220,220,1)",
          pointHoverBorderWidth: 2,
          pointRadius: 1,
          pointHitRadius: 10,
          data : [{% for item in hum %}
                    {{item}},
                  {% endfor %}],
          spanGaps: false
      }]
    }

    // get chart canvas
    var holder = document.getElementById("humChart");
    var ctx = document.getElementById("humChart").getContext("2d");

    // create the chart using the chart canvas
    var humChart = new Chart(ctx, {
      type: 'line',
      data: chartData,
      options: {
        tooltips: {
          enabled: true,
          mode: 'single',
          callbacks: {
            label: function(tooltipItems, data) {
                     return tooltipItems.yLabel + '%';
                   }
          }
        },
      }
    });
  
  </script>

    <script>
		var g1, g2;
		document.addEventListener("DOMContentLoaded", function(event) {
			g1 = new JustGage({
				id: "g1",
				value: {{temp_last}},
				valueFontColor: "white",
				titleFontColor: "white",
				min: -10,
				max: 50,
				title: "In Portacom TEMPERATURE",
				label: "Celcius"
			});

			g2 = new JustGage({
				id: "g2",
				value: {{hum_last}},
				valueFontColor: "white",
				titleFontColor: "white",
				min: 0,
				max: 100,
				title: "In Portacom HUMIDITY",
				label: "%"
			});

		});
    </script>
  </body>
</html>
